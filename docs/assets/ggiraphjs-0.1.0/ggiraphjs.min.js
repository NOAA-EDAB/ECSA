var ggiraphjs=function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){t.exports=d3},function(t,e,n){"use strict";var i;!function(){var n=void 0!==e&&e||{}||this||window;void 0===(i=function(){return n}.apply(e,[]))||(t.exports=i);var o="http://www.w3.org/2000/xmlns/",r=/url\(["']?(.+?)["']?\)/,a={woff2:"font/woff2",woff:"font/woff",otf:"application/x-font-opentype",ttf:"application/x-font-ttf",eot:"application/vnd.ms-fontobject",sfnt:"application/font-sfnt",svg:"image/svg+xml"},s=function(t){if(!function(t){return t instanceof HTMLElement||t instanceof SVGElement}(t))throw new Error("an HTMLElement or SVGElement is required; got "+t)},l=function(t,e,n){var i=t.viewBox&&t.viewBox.baseVal&&t.viewBox.baseVal[n]||null!==e.getAttribute(n)&&!e.getAttribute(n).match(/%$/)&&parseInt(e.getAttribute(n))||t.getBoundingClientRect()[n]||parseInt(e.style[n])||parseInt(window.getComputedStyle(t).getPropertyValue(n));return void 0===i||null===i||isNaN(parseFloat(i))?0:i},c=function(t){for(var e=window.atob(t.split(",")[1]),n=t.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(e.length),o=new Uint8Array(i),r=0;r<e.length;r++)o[r]=e.charCodeAt(r);return new Blob([i],{type:n})},d=function(t,e){var n=t.cssText.match(r),i=n&&n[1]||"";if(i&&!i.match(/^data:/)&&"about:blank"!==i){var o=i.startsWith("../")?e+"/../"+i:i.startsWith("./")?e+"/."+i:i;return{text:t.cssText,format:function(t){var e=Object.keys(a).filter(function(e){return t.indexOf("."+e)>0}).map(function(t){return a[t]});return e?e[0]:(console.error("Unknown font format for "+t+". Fonts may not be working correctly."),"application/octet-stream")}(o),url:o}}},u=function(t){return Promise.all(Array.from(t.querySelectorAll("image")).map(function(t){var e=t.getAttributeNS("http://www.w3.org/1999/xlink","href")||t.getAttribute("href");return e?(function(t){return t&&0===t.lastIndexOf("http",0)&&-1===t.lastIndexOf(window.location.host)}(e)&&(e+=(-1===e.indexOf("?")?"?":"&")+"t="+(new Date).valueOf()),new Promise(function(n,i){var o=document.createElement("canvas"),r=new Image;r.crossOrigin="anonymous",r.src=e,r.onerror=function(){return i(new Error("Could not load "+e))},r.onload=function(){o.width=r.width,o.height=r.height,o.getContext("2d").drawImage(r,0,0),t.setAttributeNS("http://www.w3.org/1999/xlink","href",o.toDataURL("image/png")),n(!0)}})):Promise.resolve(null)}))},h={},f=function(t){return Promise.all(t.map(function(t){return new Promise(function(e,n){if(h[t.url])return e(h[t.url]);var i=new XMLHttpRequest;i.addEventListener("load",function(){var n=function(t){for(var e="",n=new Uint8Array(t),i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return window.btoa(e)}(i.response),o=t.text.replace(r,'url("data:'+t.format+";base64,"+n+'")')+"\n";h[t.url]=o,e(o)}),i.addEventListener("error",function(n){console.warn("Failed to load font from: "+t.url,n),h[t.url]=null,e(null)}),i.addEventListener("abort",function(n){console.warn("Aborted loading font from: "+t.url,n),e(null)}),i.open("GET",t.url),i.responseType="arraybuffer",i.send()})})).then(function(t){return t.filter(function(t){return t}).join("")})},p=null,g=function(t,e){var n=e||{},i=n.selectorRemap,o=n.modifyStyle,r=n.modifyCss,a=n.fonts,s=r||function(t,e){return(i?i(t):t)+"{"+(o?o(e):e)+"}\n"},l=[],c=void 0===a,u=a||[];return(p||(p=Array.from(document.styleSheets).map(function(t){try{return{rules:t.cssRules,href:t.href}}catch(e){return console.warn("Stylesheet could not be loaded: "+t.href,e),{}}}))).forEach(function(e){var n=e.rules,i=e.href;n&&Array.from(n).forEach(function(e){if(void 0!==e.style)if(function(t,e){if(e)try{return t.querySelector(e)||t.parentNode&&t.parentNode.querySelector(e)}catch(t){console.warn('Invalid CSS selector "'+e+'"',t)}}(t,e.selectorText))l.push(s(e.selectorText,e.style.cssText));else if(c&&e.cssText.match(/^@font-face/)){var n=d(e,i);n&&u.push(n)}else l.push(e.cssText)})}),f(u).then(function(t){return l.join("\n")+t})};n.prepareSvg=function(t,e,n){s(t);var i=e||{},r=i.left,a=void 0===r?0:r,c=i.top,d=void 0===c?0:c,h=i.width,f=i.height,p=i.scale,v=void 0===p?1:p,m=i.responsive,y=void 0!==m&&m;return u(t).then(function(){var i=t.cloneNode(!0),r=(e||{}).backgroundColor,s=void 0===r?"transparent":r;i.style.backgroundColor=s;var c=function(t,e,n,i){if("svg"===t.tagName)return{width:n||l(t,e,"width"),height:i||l(t,e,"height")};if(t.getBBox){var o=t.getBBox(),r=o.x,a=o.y;return{width:r+o.width,height:a+o.height}}}(t,i,h,f),u=c.width,p=c.height;if("svg"!==t.tagName){if(!t.getBBox)return void console.error("Attempted to render non-SVG element",t);i.setAttribute("transform",i.getAttribute("transform").replace(/translate\(.*?\)/,""));var m=document.createElementNS("http://www.w3.org/2000/svg","svg");m.appendChild(i),i=m}return i.setAttribute("version","1.1"),i.setAttribute("viewBox",[a,d,u,p].join(" ")),i.getAttribute("xmlns")||i.setAttributeNS(o,"xmlns","http://www.w3.org/2000/svg"),i.getAttribute("xmlns:xlink")||i.setAttributeNS(o,"xmlns:xlink","http://www.w3.org/1999/xlink"),y?(i.removeAttribute("width"),i.removeAttribute("height"),i.setAttribute("preserveAspectRatio","xMinYMin meet")):(i.setAttribute("width",u*v),i.setAttribute("height",p*v)),Array.from(i.querySelectorAll("foreignObject > *")).forEach(function(t){t.getAttribute("xmlns")||t.setAttributeNS(o,"xmlns","http://www.w3.org/1999/xhtml")}),g(t,e).then(function(t){var e=document.createElement("style");e.setAttribute("type","text/css"),e.innerHTML="<![CDATA[\n"+t+"\n]]>";var o=document.createElement("defs");o.appendChild(e),i.insertBefore(o,i.firstChild);var r=document.createElement("div");r.appendChild(i);var a=r.innerHTML.replace(/NS\d+:href/gi,'xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href');if("function"!=typeof n)return{src:a,width:u,height:p};n(a,u,p)})})},n.svgAsDataUri=function(t,e,i){s(t);var o=n.prepareSvg(t,e).then(function(t){var e=t.src;return"data:image/svg+xml;base64,"+window.btoa(function(t){return decodeURIComponent(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(t,e){var n=String.fromCharCode("0x"+e);return"%"===n?"%25":n}))}('<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" [<!ENTITY nbsp "&#160;">]>'+e))});return"function"==typeof i?o.then(i):o},n.svgAsPngUri=function(t,e,i){s(t);var o=e||{},r=o.encoderType,a=void 0===r?"image/png":r,l=o.encoderOptions,c=void 0===l?.8:l,d=o.canvg,u=function(t){var e=t.src,n=t.width,o=t.height,r=document.createElement("canvas"),s=r.getContext("2d"),l=window.devicePixelRatio||1;r.width=n*l,r.height=o*l,r.style.width=r.width+"px",r.style.height=r.height+"px",s.setTransform(l,0,0,l,0,0),d?d(r,e):s.drawImage(e,0,0);var u=void 0;try{u=r.toDataURL(a,c)}catch(t){if("undefined"!=typeof SecurityError&&t instanceof SecurityError||"SecurityError"===t.name)return void console.error("Rendered SVG images cannot be downloaded in this browser.");throw t}return"function"==typeof i&&i(u),Promise.resolve(u)};return d?n.prepareSvg(t,e).then(u):n.svgAsDataUri(t,e).then(function(t){return new Promise(function(e,n){var i=new Image;i.onload=function(){return e(u({src:i,width:i.width,height:i.height}))},i.onerror=function(){n("There was an error loading the data URI as an image on the following SVG\n"+window.atob(t.slice(26))+"Open the following link to see browser's diagnosis\n"+t)},i.src=t})})},n.download=function(t,e){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(c(e),t);else{var n=document.createElement("a");if("download"in n){n.download=t,n.style.display="none",document.body.appendChild(n);try{var i=c(e),o=URL.createObjectURL(i);n.href=o,n.onclick=function(){return requestAnimationFrame(function(){return URL.revokeObjectURL(o)})}}catch(t){console.warn("This browser does not support object URLs. Falling back to string URL."),n.href=e}n.click(),document.body.removeChild(n)}else window.open(e,"_temp","menubar=no,toolbar=no,status=no")}},n.saveSvg=function(t,e,i){s(t),n.svgAsDataUri(t,i||{},function(t){return n.download(e,t)})},n.saveSvgAsPng=function(t,e,i){s(t),n.svgAsPngUri(t,i||{},function(t){return n.download(e,t)})}}()},function(t,e,n){t.exports=n(3)},function(t,e,n){"use strict";n.r(e);var i=n(0),o=n(1);function r(){var t,e=navigator.userAgent,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?"IE "+((t=/\brv[ :]+(\d+)/g.exec(e)||[])[1]||""):"Chrome"===n[1]&&null!==(t=e.match(/\b(OPR|Edge)\/(\d+)/))?t.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(t=e.match(/version\/(\d+)/i))&&n.splice(1,1,t[1]),n.join(" "))}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.containerid=e,this.dataSelected=[],this.typeSelection=null,this.svgid=null,this.csswidth=null,this.inputId=null,this.zoomer=null}return function(t,e,n){e&&a(t.prototype,e),n&&a(t,n)}(t,[{key:"setSvgId",value:function(t){this.svgid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"id"+t()+t()}(),this.uid=t}},{key:"setSvgWidth",value:function(t){this.csswidth=Math.round(100*t)+"%"}},{key:"setZoomer",value:function(t,e){this.zoomer=i.zoom().scaleExtent([t,e])}},{key:"tooltipClassname",value:function(){return"tooltip_"+this.svgid}},{key:"selectedClassname",value:function(){return"clicked_"+this.svgid}},{key:"hoverClassname",value:function(){return"hover_"+this.svgid}},{key:"addStyle",value:function(t,e,n){var o=i.select("#"+this.containerid+" style");o.size()>0&&o.remove();var r=".tooltip_"+this.svgid+t+"\n.hover_"+this.svgid+e+"\n.clicked_"+this.svgid+n+"\n";i.select("#"+this.containerid).append("style").text(r)}},{key:"setInputId",value:function(t){this.inputId=t}},{key:"addUI",value:function(t,e,n,i){!function(t,e,n,i,r){var a=d3.select("#"+t.containerid+" .girafe_container_std").append("div").classed("ggiraph-toolbar",!0);if(a.classed(r,!0),e){var s=a.append("div").classed("ggiraph-toolbar-block",!0).classed("shinyonly",!0);s.append("a").classed("ggiraph-toolbar-icon",!0).classed("neutral",!0).attr("title","lasso selection").on("click",function(){t.lasso_on(!0)}).html("<svg width='15pt' height='15pt' viewBox='0 0 230 230'><g><ellipse ry='65.5' rx='86.5' cy='94' cx='115.5' stroke-width='20' fill='transparent'/><ellipse ry='11.500001' rx='10.5' cy='153' cx='91.5' stroke-width='20' fill='transparent'/><line y2='210.5' x2='105' y1='164.5' x1='96' stroke-width='20'/></g></svg>"),s.append("a").classed("ggiraph-toolbar-icon",!0).classed("drop",!0).attr("title","lasso selection").on("click",function(){t.lasso_on(!1)}).html("<svg width='15pt' height='15pt' viewBox='0 0 230 230'><g><ellipse ry='65.5' rx='86.5' cy='94' cx='115.5' stroke-width='20' fill='transparent'/><ellipse ry='11.500001' rx='10.5' cy='153' cx='91.5' stroke-width='20' fill='transparent'/><line y2='210.5' x2='105' y1='164.5' x1='96' stroke-width='20'/></g></svg>")}if(n){var l=a.append("div").classed("ggiraph-toolbar-block",!0);l.append("a").classed("ggiraph-toolbar-icon",!0).classed("neutral",!0).attr("title","pan-zoom reset").on("click",function(){t.zoomIdentity()}).html("<svg width='15pt' height='15pt' viewBox='0 0 512 512'><g><polygon points='274,209.7 337.9,145.9 288,96 416,96 416,224 366.1,174.1 302.3,238 '/><polygon points='274,302.3 337.9,366.1 288,416 416,416 416,288 366.1,337.9 302.3,274'/><polygon points='238,302.3 174.1,366.1 224,416 96,416 96,288 145.9,337.9 209.7,274'/><polygon points='238,209.7 174.1,145.9 224,96 96,96 96,224 145.9,174.1 209.7,238'/></g><svg>"),l.append("a").classed("ggiraph-toolbar-icon",!0).classed("neutral",!0).attr("title","activate pan-zoom").on("click",function(){t.zoomOn()}).html("<svg width='15pt' height='15pt' viewBox='0 0 512 512'><g><ellipse ry='150' rx='150' cy='213' cx='203.5' stroke-width='50' fill='transparent'/><line y2='455.5' x2='416' y1='331.5' x1='301' stroke-width='50'/></g></svg>"),l.append("a").classed("ggiraph-toolbar-icon",!0).classed("drop",!0).attr("title","deactivate pan-zoom").on("click",function(){t.zoomOff()}).html("<svg width='15pt' height='15pt' viewBox='0 0 512 512'><g><ellipse ry='150' rx='150' cy='213' cx='203.5' stroke-width='50' fill='transparent'/><line y2='455.5' x2='416' y1='331.5' x1='301' stroke-width='50'/><line y2='455' x2='0' y1='0' x1='416' stroke-width='30'/></g></svg>")}i&&a.append("div").classed("ggiraph-toolbar-block",!0).append("a").classed("ggiraph-toolbar-icon",!0).classed("neutral",!0).attr("title","download png").on("click",function(){"undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]")?o.saveSvgAsPng(document.getElementById(t.svgid),"diagram.png"):console.error("This navigator does not support Promises")}).html("<svg width='15pt' height='15pt' viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'><g><polygon points='95 275 95 415 415 415 415 275 375 275 375 380 135 380 135 275'/><polygon points='220 30 220 250 150 175 150 245 250 345 350 245 350 175 280 250 280 30'/></g></svg>")}(this,t,e,n,i)}},{key:"removeContent",value:function(){var t=i.select("#"+this.containerid+" .girafe_container_std svg");t.size()>0&&i.select(".tooltip_"+t.attr("id")).remove();var e=i.select("#"+this.containerid+" div.girafe_container_std");e.size()>0&&e.remove();var n="."+this.tooltipClassname(),o=i.select(n);o.size()>0&&o.remove()}},{key:"addSvg",value:function(t,e){this.removeContent(),i.select("#"+this.containerid).append("div").attr("class","girafe_container_std").html(t),i.select("body").append("div").attr("class",this.tooltipClassname()).style("position","absolute").style("opacity",0),function(t){var e=t.indexOf("{"),n=t.substring(e+1,t.lastIndexOf("}")),i=t.substring(0,e),o=i.substring(i.indexOf("(")+1,i.lastIndexOf(")")).split(",");function r(){return Function.apply(this,o)}return o.push(n),r.prototype=Function.prototype,new r}(e)(),i.select("#"+this.uid).attr("id",this.svgid)}},{key:"IEFixResize",value:function(t,e){if("IE 11"==r()||"MSIE"===r().substring(0,4)){var n=this.containerid,o=this.svgid;i.select("#"+o).classed("girafe_svg_ie",!0),i.select("#"+n+" div").classed("girafe_container_ie",!0).style("width",Math.round(100*t)+"%").style("padding-bottom",Math.round(t*e*100)+"%")}}},{key:"adjustSize",value:function(t,e){var n=this.containerid,o=this.svgid;i.select("#"+o).attr("preserveAspectRatio","xMidYMin"),i.select("#"+n+" .girafe_container_std").style("width",this.csswidth),i.select("#"+o).attr("width",null).attr("height",null),HTMLWidgets.shinyMode?i.select("#"+o).style("width","100%").style("height",e).style("margin-left","auto").style("margin-right","auto"):i.select("#"+n).style("width",null).style("height",null)}},{key:"setSize",value:function(t,e){var n=this.svgid;HTMLWidgets.shinyMode&&i.select("#"+n).style("height",e)}},{key:"animateToolbar",value:function(){var t=this.containerid;i.select("#"+t).on("mouseover",function(e){i.select("#"+t+" div.ggiraph-toolbar").transition().duration(200).style("opacity",.8)}).on("mouseout",function(e){i.select("#"+t+" div.ggiraph-toolbar").transition().duration(500).style("opacity",0)})}},{key:"animateGElements",value:function(t,e,n,o,r,a,s,l){var c=this.hoverClassname(),d=i.selectAll("#"+this.svgid+" *"),u="."+this.tooltipClassname(),h=this.svgid,f=this.containerid;d.on("mouseover",function(a){null!==this.getAttribute("data-id")&&i.selectAll("#"+h+' *[data-id="'+this.getAttribute("data-id")+'"]').classed(c,!0);if(null!==this.getAttribute("title")){if(i.select(u).transition().duration(r).style("opacity",t),s){var d=this.getAttribute("fill");i.select(u).style("background-color",d)}if(l){var p=this.getAttribute("stroke");i.select(u).style("border-color",p)}if(i.select(u).html(this.getAttribute("title")),o)i.select(u).style("left",i.event.pageX+e+"px").style("top",i.event.pageY+n+"px");else{var g=i.select("#"+f).node().getBoundingClientRect();i.select(u).style("left",e+g.left+"px").style("top",document.documentElement.scrollTop+g.y+n+"px")}}}).on("mousemove",function(t){if(null!==this.getAttribute("title"))if(o)i.select(u).style("left",i.event.pageX+e+"px").style("top",i.event.pageY+n+"px");else{var r=i.select("#"+f).node().getBoundingClientRect();i.select(u).style("left",e+r.left+"px").style("top",document.documentElement.scrollTop+r.y+n+"px")}}).on("mouseout",function(t){null!==this.getAttribute("data-id")&&i.selectAll("#"+h+' *[data-id="'+i.select(i.event.currentTarget).attr("data-id")+'"]').classed(c,!1);null!==this.getAttribute("title")&&i.select(u).transition().duration(a).style("opacity",0)})}},{key:"setSelected",value:function(t){this.dataSelected=t,this.refreshSelected(),this.inputId&&Shiny.onInputChange(this.inputId,this.dataSelected)}},{key:"selectizeMultiple",value:function(){var t=this;i.selectAll("#"+this.svgid+" *[data-id]").on("click",function(e,n){var o=t.dataSelected,r=i.select(this).attr("data-id"),a=o.indexOf(r);a<0?o.push(r):o.splice(a,1),t.dataSelected=o,t.refreshSelected(),t.inputId&&Shiny.onInputChange(t.inputId,t.dataSelected)})}},{key:"selectizeSingle",value:function(){var t=this;i.selectAll("#"+this.svgid+" *[data-id]").on("click",function(e,n){var o=t.dataSelected,r=i.select(this).attr("data-id");o=o.indexOf(r)<0?[r]:[],t.dataSelected=o,t.refreshSelected(),t.inputId&&Shiny.onInputChange(t.inputId,t.dataSelected)})}},{key:"selectizeNone",value:function(){i.selectAll("#"+this.svgid+" *[data-id]").on("click",null)}},{key:"refreshSelected",value:function(){var t=this.selectedClassname(),e=this.svgid,n=i.select("#"+e);n.selectAll("*[data-id]").classed(t,!1);var o=this;i.selectAll(o.dataSelected).each(function(e,i){n.selectAll('*[data-id="'+o.dataSelected[i]+'"]').classed(t,!0)})}},{key:"zoomOn",value:function(){var t=this.svgid;i.select("#"+this.containerid).call(this.zoomer.on("zoom",function(){i.select("#"+t+" g").attr("transform",i.event.transform)}))}},{key:"zoomIdentity",value:function(){i.select("#"+this.containerid).call(this.zoomer.transform,i.zoomIdentity)}},{key:"zoomOff",value:function(){i.select("#"+this.containerid).call(this.zoomer.on("zoom",null))}},{key:"isSelectable",value:function(){var t=this.svgid;return i.select("#"+t).selectAll("*[data-id]").size()>0}},{key:"lasso_on",value:function(t){var e=this.svgid,n=this,o=i.lasso();o=o.closePathSelect(!0).closePathDistance(100).items(i.select("#"+e).selectAll("*[data-id]")).targetArea(i.select("#"+e)).on("start",function(){}).on("draw",function(){}).on("end",function(){o.selectedItems().each(function(e,o){i.select(this).classed(n.selectedClassname,!0);var r=i.select(this).attr("data-id"),a=n.dataSelected.indexOf(r);a<0&&t?n.dataSelected.push(r):a>=0&&!t&&n.dataSelected.splice(a,1)}),n.refreshSelected(),i.select("#"+e).on(".dragstart",null).on(".drag",null).on(".dragend",null),n.inputId&&Shiny.onInputChange(n.inputId,n.dataSelected)}),i.select("#"+e).call(o)}}]),t}();function l(t){return new s(t)}n.d(e,"newgi",function(){return l})}]);